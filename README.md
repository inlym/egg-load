# egg-load

[![npm version](https://img.shields.io/npm/v/egg-load)](https://www.npmjs.com/package/egg-load)  [![MIT](https://img.shields.io/npm/l/egg-load)](https://github.com/inlym/egg-load/blob/master/LICENSE)  [![npm](https://img.shields.io/npm/dw/egg-load)](https://www.npmjs.com/package/egg-load)

![egg-load-image](https://img.inlym.com/1843460a76f544f384bc276bed6da9e8.png)


è‡ªåŠ¨æŒ‚è½½ç¬¬ä¸‰æ–¹æ¨¡å—è‡³ Egg.js æ¡†æ¶ä¸Š


## ç›®å½•

-   [ä»‹ç»](#ä»‹ç»)
-   [å®‰è£…](#å®‰è£…)
-   [ä½¿ç”¨](#ä½¿ç”¨)
    -   [å¯ç”¨æ’ä»¶](#å¯ç”¨æ’ä»¶)
    -   [é…ç½®æ–¹å¼](#é…ç½®æ–¹å¼)
    -   [ä½¿ç”¨è¯´æ˜](#ä½¿ç”¨è¯´æ˜)
-   [ç¤ºä¾‹](#ç¤ºä¾‹)
-   [ç›¸å…³](#ç›¸å…³)
-   [ä½œè€…](#ä½œè€…)
-   [å‚ä¸](#å‚ä¸)
-   [è®¸å¯è¯](#è®¸å¯è¯)





## ä»‹ç»

åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œéœ€è¦ç”¨åˆ°ä¸€äº›ç¬¬ä¸‰æ–¹æ¨¡å—ï¼ˆmoduleï¼‰ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨ `require` å°±å¯ä»¥å°†æ¨¡å—å¼•å…¥ä½¿ç”¨äº†ã€‚ä½†æ˜¯å¦‚æœå¤šä¸ªæ–‡ä»¶ä¸­ç”¨åˆ°åŒä¸€ä¸ªæ¨¡å—ï¼Œåœ¨æ¯ä¸ªæ–‡ä»¶ä¸­éƒ½éœ€è¦ `require` å¼•å…¥ï¼Œæ˜¾å¾—æœ‰äº›éº»çƒ¦ï¼ŒåŒæ—¶ä¹Ÿä¸åˆ©äºé¡¹ç›®å·¥ç¨‹åŒ–ç®¡ç†ã€‚

æœ¬æ’ä»¶å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œè¯ç”Ÿçš„ï¼Œèƒ½å¤Ÿå°†æŒ‡å®šçš„ç¬¬ä¸‰æ–¹æ¨¡å—æŒ‚è½½åˆ° Egg.js æ¡†æ¶çš„ `app` å±æ€§ä¸Šï¼Œä»¥ä¾¿è°ƒç”¨ã€‚


æœ¬æ’ä»¶å®Œç¾é€‚é… **Egg.js** æ¡†æ¶ï¼Œåªéœ€è¦æŒ‰ç…§æ¡†æ¶è¦æ±‚å¯ç”¨æ’ä»¶ï¼Œæ ¹æ®æ–‡æ¡£è¦æ±‚è¿›è¡Œé…ç½®ä½¿ç”¨å³å¯ã€‚



## å®‰è£…

æŒ‰ç…§é€šç”¨çš„æ–¹å¼ä½¿ç”¨ npm ä¸‹è½½å®‰è£…åˆ°ä½ çš„é¡¹ç›®ä¸‹å³å¯ï¼Œæ— éœ€å…¨å±€å®‰è£…ã€‚

å®‰è£…å‘½ä»¤ï¼š

```shell
npm i egg-load
```



## ä½¿ç”¨

åœ¨ä½¿ç”¨å‰ï¼Œè¯·ç¡®ä¿ä½ å·²ç»é˜…è¯» Egg.js æ¡†æ¶å…³äº**æ’ä»¶**çš„ [æ–‡æ¡£](https://eggjs.org/zh-cn/basics/plugin.html) ã€‚

ä¸‹é¢è¯´æ˜å¦‚ä½•é…ç½®ä»¥åŠä½¿ç”¨æ’ä»¶ã€‚



### å¯ç”¨æ’ä»¶

åœ¨ `config/plugin.js` æ–‡ä»¶ä¸­å£°æ˜å¯ç”¨æ’ä»¶ï¼š

```js
exports.load = {
  /** æ˜¯å¦å¯ç”¨æ’ä»¶ï¼Œtrue ä¸ºå¯ç”¨ï¼Œfalse ä¸ºç¦ç”¨ */
  enable: true,

  /** æŒ‡å®šæ’ä»¶ä½¿ç”¨çš„åŒ…ï¼Œè¯·å¡«å†™ 'egg-load' */
  package: 'egg-load',
};
```



### é…ç½®æ–¹å¼


åœ¨ `config/config.${env}.js`æ–‡ä»¶é…ç½®æ’ä»¶ï¼š

```js
exports.load = {
  /** éœ€è¦æŒ‚è½½çš„æ¨¡å—åˆ—è¡¨ */
  module: [
    /** åˆ—è¡¨é¡¹æ”¯æŒå¯¹è±¡ï¼ˆobjectï¼‰å’Œå­—ç¬¦ä¸²ï¼ˆstringï¼‰ä¸¤ç§å½¢å¼ */
    {
      /** éœ€è¦æŒ‚è½½çš„ npm åŒ…çš„åŒ…åï¼Œä¾‹å¦‚ axiosï¼Œå¿…å¡« */
      package: 'pkg1-name',

      /** æŒ‚è½½çš„å±æ€§åï¼Œä¾‹å¦‚å¡« abcï¼Œè¯¥æ¨¡å—å¯ä»¥é€šè¿‡ app.abc è¿›è¡Œè®¿é—®ï¼Œé»˜è®¤ä¸ºåŒ…åï¼Œé€‰å¡« */
      name: 'abc',

      /** æ˜¯å¦ç¦ç”¨ï¼Œé»˜è®¤ä¸ºå¦ï¼Œé€‰å¡« */
      disabled: false,
    },

  /** ä½¿ç”¨å­—ç¬¦ä¸²å½¢å¼åªéœ€è¦è¾“å…¥åŒ…åå³å¯ï¼Œå…¶ä»–å±æ€§æŒ‰ç…§é»˜è®¤å±æ€§è‡ªåŠ¨è®¾ç½® */
    'pkg2-name',
  ],

  /** æ˜¯å¦æŒ‚è½½åˆ° app ä¸Šï¼Œé»˜è®¤å¼€å¯ */
  app: true,

  /** æ˜¯å¦æŒ‚è½½åˆ° agent ä¸Šï¼Œé»˜è®¤å…³é—­ */
  agent: false,
}
```

å„é…ç½®é¡¹çš„å«ä¹‰æ˜¯ï¼š

|  å±æ€§  |       ç±»å‹       | é»˜è®¤å€¼ | æ˜¯å¦å¿…å¡« |                             è¯´æ˜                             |
| :----: | :--------------: | :----: | :------: | :----------------------------------------------------------: |
| module | object \| string |   æ—    |    å¦    | éœ€è¦æŒ‚è½½çš„æ¨¡å—åˆ—è¡¨ï¼Œåˆ—è¡¨é¡¹æ”¯æŒå¯¹è±¡ï¼ˆobjectï¼‰å’Œå­—ç¬¦ä¸²ï¼ˆstringï¼‰ä¸¤ç§å½¢å¼ |
|  app   |      string      |  true  |    å¦    |                 æ˜¯å¦æŒ‚è½½åˆ° app ä¸Šï¼Œé»˜è®¤å¼€å¯                  |
| agent  |     boolean      | false  |    å¦    |                æ˜¯å¦æŒ‚è½½åˆ° agent ä¸Šï¼Œé»˜è®¤å…³é—­                 |



### ä½¿ç”¨è¯´æ˜

æŒ‰ç…§ä¸Šè¿°æ–¹å¼é…ç½®åï¼Œç¬¬ä¸‰æ–¹æ¨¡å—å°†è‡ªåŠ¨æŒ‚è½½åˆ°äº† `app` ä¸Šï¼Œå¯ä»¥é€šè¿‡æŒ‡å®šçš„å±æ€§åè¿›è¡Œè®¿é—®ã€‚



å¦å¤–ä¸€ç‚¹éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œé…ç½®å¼•å…¥çš„ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œéœ€è¦è‡ªè¡Œä¸‹è½½å®‰è£…ï¼Œæœ¬æ’ä»¶å¹¶ä¸ä¼šå¸®åŠ©ä½ è‡ªåŠ¨ä¸‹è½½ã€‚



## ç¤ºä¾‹

æˆ‘ä»¬æ¨¡æ‹Ÿä»¥ä¸‹è¿™ä¸ªä½¿ç”¨åœºæ™¯ï¼Œæ¥æ¼”ç¤ºå¦‚ä½•é…ç½®å’Œä½¿ç”¨æœ¬æ’ä»¶ï¼š

>   å‘ç° axios å’Œ only ä¸¤ä¸ªæ¨¡å—çš„ä½¿ç”¨ç‡éå¸¸é«˜ï¼Œäºæ˜¯å‡†å¤‡å°†è¿™ä¸¤ä¸ªæ¨¡å—æŒ‚è½½åˆ°æ¡†æ¶ä¸Šã€‚



åœ¨ `config/plugin.js` æ–‡ä»¶ä¸­å£°æ˜å¯ç”¨æ’ä»¶ï¼š

```js
exports.load = {
  enable: true,
  package: 'egg-load',
};
```



åœ¨ `config/config.${env}.js`æ–‡ä»¶é…ç½®æ’ä»¶ï¼ˆç¤ºä¾‹æ˜¯ä¸€ä¸ªå…¸å‹çš„é…ç½®æ–¹å¼ï¼‰ï¼š

```js
exports.load = {
  module: [
    {
      package: 'axios',
      name: 'req',
    },
    'only',
  ],
}
```



é€šè¿‡ä¸Šè¿°ç¤ºä¾‹æ–¹å¼é…ç½®åï¼Œå¯ä»¥é€šè¿‡ `app.res` è®¿é—® axios æ¨¡å—ï¼Œä»¥åŠé€šè¿‡ `app.only` è®¿é—® only æ¨¡å—ã€‚



## ç›¸å…³

ä»¥ä¸‹æ˜¯ä½œè€…å¼€å‘çš„ Egg.js æ¡†æ¶çš„æ’ä»¶ç³»åˆ—ï¼Œå·²ç”¨äºä½œè€…çš„ç”Ÿäº§é¡¹ç›®ä¸­ï¼Œæ¨èä½¿ç”¨ã€‚
-   [egg-apigw-tracer](https://github.com/inlym/egg-apigw-tracer) - âš¡ é€‚é… API ç½‘å…³çš„ HTTP è¯·æ±‚ç¤ºè¸ªå™¨ï¼Œç”¨äº Egg.js æ¡†æ¶
-   [egg-aliyun-tablestore](https://github.com/inlym/egg-aliyun-tablestore) - ğŸšš é˜¿é‡Œäº‘è¡¨æ ¼å­˜å‚¨ï¼ˆTablestoreï¼‰æ’ä»¶ï¼Œç”¨äº Egg.js æ¡†æ¶
-   [egg-load](https://github.com/inlym/egg-load) - ğŸš€ è‡ªåŠ¨æŒ‚è½½ç¬¬ä¸‰æ–¹æ¨¡å—è‡³ Egg.js æ¡†æ¶ä¸Š




## ä½œè€…

æˆ‘æ˜¯ [inlym](https://www.inlym.com) ï¼Œä¸€ä¸ªäº§å“ç»ç†å’Œå…¨æ ˆå¼€å‘è€…ã€‚



å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–è€…å»ºè®®ï¼Œæ¬¢è¿è”ç³»æˆ‘ï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„è”ç³»æ–¹å¼ï¼š

-   é‚®ç®±ï¼šinlym@qq.com
-   ä¸»é¡µï¼š[www.inlym.com](https://www.inlym.com)



## å‚ä¸

éå¸¸æ¬¢è¿ä½ èƒ½å¤Ÿå‚ä¸è¿™ä¸ªé¡¹ç›®çš„å¼€å‘å’Œç»´æŠ¤ã€‚

ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼å‚ä¸åˆ°é¡¹ç›®ä¸­ï¼š

1.  æå»ºè®®å’Œéœ€æ±‚ã€‚å¯¹äºå‡ å¥è¯å°±èƒ½è¯´æ¸…æ¥šçš„å»ºè®®å’Œéœ€æ±‚ï¼Œä½ å¯ä»¥ç›´æ¥ æä¸€ä¸ª [New Issue](https://github.com/inlym/egg-load/issues/new) ã€‚
2.  Fork é¡¹ç›®ï¼Œä¿®æ”¹ä»£ç ï¼Œç„¶åæäº¤ Pull requests ã€‚ï¼ˆæäº¤å‰è¯·æ£€æŸ¥åŠ¡å¿…é€šè¿‡ ESLint æ£€æŸ¥ï¼‰



## è®¸å¯è¯

æœ¬æ’ä»¶ä½¿ç”¨ [MIT](LICENSE) è®¸å¯è¯ã€‚
